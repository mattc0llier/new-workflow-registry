{
  "name": "leonardo-ai",
  "type": "registry:block",
  "title": "Leonardo AI Image Generation",
  "description": "Generate creative images with Leonardo AI",
  "registryDependencies": [],
  "dependencies": ["@vercel/workflow"],
  "files": [
    {
      "path": "registry/steps/leonardo-ai.tsx",
      "type": "registry:component",
      "content": "import { FatalError, retryableError } from 'workflow';\n\ntype LeonardoParams = {\n  prompt: string;\n  model_id?: string;\n  width?: number;\n  height?: number;\n};\n\nexport async function leonardoAI(params: LeonardoParams) {\n  'use step';\n\n  const apiKey = process.env.LEONARDO_API_KEY;\n\n  if (!apiKey) {\n    throw new FatalError('LEONARDO_API_KEY is required');\n  }\n\n  // Generate image\n  const response = await fetch(\n    'https://cloud.leonardo.ai/api/rest/v1/generations',\n    {\n      method: 'POST',\n      headers: {\n        Authorization: `Bearer ${apiKey}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        prompt: params.prompt,\n        modelId: params.model_id || 'b24e16ff-06e3-43eb-8d33-4416c2d75876',\n        width: params.width || 1024,\n        height: params.height || 1024,\n        num_images: 1,\n      }),\n    }\n  );\n\n  if (!response.ok) {\n    throw new FatalError(`Leonardo API error: ${response.status}`);\n  }\n\n  const { sdGenerationJob } = await response.json();\n\n  // Poll for completion\n  let result;\n  while (true) {\n    const pollResponse = await fetch(\n      `https://cloud.leonardo.ai/api/rest/v1/generations/${sdGenerationJob.generationId}`,\n      {\n        headers: {\n          Authorization: `Bearer ${apiKey}`,\n        },\n      }\n    );\n\n    result = await pollResponse.json();\n\n    if (result.generations_by_pk.status === 'COMPLETE') {\n      break;\n    } else if (result.generations_by_pk.status === 'FAILED') {\n      throw retryableError('Image generation failed');\n    }\n\n    await new Promise((resolve) => setTimeout(resolve, 2000));\n  }\n\n  return result.generations_by_pk.generated_images[0].url;\n}\n",
      "target": "components/steps/leonardo-ai.tsx"
    }
  ],
  "envVars": {
    "LEONARDO_API_KEY": ""
  }
}
