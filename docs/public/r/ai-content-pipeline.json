{
  "name": "ai-content-pipeline",
  "type": "registry:block",
  "title": "AI Content Generation Pipeline",
  "description": "Generate blog content with AI, create a cover image, and distribute via email",
  "registryDependencies": [],
  "dependencies": [],
  "files": [
    {
      "path": "registry/workflows/ai-content-pipeline.tsx",
      "type": "registry:component",
      "content": "import { workflow } from '@vercel/workflow';\nimport { anthropicClaude } from '@/steps/anthropic-claude';\nimport { openaiChat } from '@/steps/openai-chat';\nimport { replicateModel } from '@/steps/replicate-model';\nimport { sendEmail } from '@/steps/send-email-resend';\nimport { sendSlackMessage } from '@/steps/send-slack-message';\n\ntype ContentPipelineParams = {\n  topic: string;\n  targetAudience: string;\n  tone: 'professional' | 'casual' | 'technical';\n  subscriberEmails: string[];\n  slackChannel: string;\n};\n\nexport const aiContentPipeline = workflow(\n  'ai-content-pipeline',\n  async (params: ContentPipelineParams) => {\n    'use workflow';\n\n    // Step 1: Generate blog content with Claude\n    const articlePrompt = `Write a comprehensive blog post about \"${params.topic}\"\nfor ${params.targetAudience}. Use a ${params.tone} tone.\nInclude an engaging introduction, main points with examples, and a conclusion.\nFormat in markdown with proper headings.`;\n\n    const article = await anthropicClaude({\n      messages: [\n        {\n          role: 'user',\n          content: articlePrompt,\n        },\n      ],\n      model: 'claude-3-5-sonnet-20241022',\n      maxTokens: 2000,\n    });\n\n    // Step 2: Create image prompt from content\n    const imagePromptRequest = await openaiChat({\n      messages: [\n        {\n          role: 'system',\n          content:\n            'You are an expert at creating detailed image generation prompts.',\n        },\n        {\n          role: 'user',\n          content: `Based on this blog post, create a detailed Stable Diffusion prompt for a professional cover image. The prompt should be visual and specific: ${article.slice(0, 500)}`,\n        },\n      ],\n      model: 'gpt-4',\n    });\n\n    // Step 3: Generate cover image\n    const coverImage = await replicateModel({\n      model: 'stability-ai/stable-diffusion',\n      input: {\n        prompt: imagePromptRequest,\n        width: 1024,\n        height: 768,\n      },\n    });\n\n    // Step 4: Send to subscribers\n    const emailPromises = params.subscriberEmails.map((email) =>\n      sendEmail({\n        to: email,\n        subject: `New Article: ${params.topic}`,\n        html: `\n          <h1>New Content Alert!</h1>\n          <img src=\"${coverImage.url}\" alt=\"Cover image\" style=\"max-width: 100%; height: auto;\">\n          <div>${article}</div>\n        `,\n      })\n    );\n\n    await Promise.all(emailPromises);\n\n    // Step 5: Notify team on Slack\n    await sendSlackMessage({\n      channel: params.slackChannel,\n      text: `ğŸ“ New blog post published: \"${params.topic}\"\\nâœ… Sent to ${params.subscriberEmails.length} subscribers\\nğŸ¨ Cover image: ${coverImage.url}`,\n    });\n\n    return {\n      success: true,\n      article,\n      coverImage: coverImage.url,\n      emailsSent: params.subscriberEmails.length,\n    };\n  }\n);\n",
      "target": "components/workflows/ai-content-pipeline.tsx"
    }
  ]
}
